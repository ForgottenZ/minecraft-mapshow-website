{% extends "base.html" %}
{% block content %}
<section class="card narrow">
  <h2>注册</h2>
  {% if not registration_enabled %}
    <p class="hint">管理员已关闭注册，如需账号请联系管理员。</p>
  {% else %}
    {% if registration_mode == "email" %}
      <form method="post" class="form-grid">
        {% if email_domain_policy != "none" and email_domain_options %}
          <label>
            邮箱
            <div class="email-split">
              <input type="text" name="email_local" value="{{ email_local or '' }}" placeholder="name" required />
              <select name="email_domain" required>
                {% for domain in email_domain_options %}
                  <option value="{{ domain }}" {% if email_domain == domain %}selected{% endif %}>{{ domain }}</option>
                {% endfor %}
              </select>
            </div>
          </label>
        {% else %}
          <label>
            邮箱
            <input type="text" name="email" value="{{ email or '' }}" required />
          </label>
        {% endif %}
        <label>
          验证码
          <input type="text" name="code" required />
        </label>
        <label>
          密码
          <input type="password" name="password" required />
        </label>
        <div class="form-inline">
          <button type="submit" formaction="{{ url_for('register_send_code') }}">发送验证码</button>
          <button type="submit" class="primary">注册</button>
        </div>
        <p class="hint">邮箱验证码有效期为 10 分钟。</p>
      </form>
    {% else %}
      <form method="post" class="form-grid">
        <label>
          用户名
          <input type="text" name="username" required />
        </label>
        <label>
          密码
          <input type="password" name="password" required />
        </label>
        <button type="submit" class="primary">注册</button>
      </form>
    {% endif %}
  {% endif %}
</section>
{% endblock %}
